# Session Management

- A web session is a sequence of network HTTP request and response transactions associated to the same user
- sessions provide the ability to establish variables – such as access rights and localization settings
    
    which will apply to each and every interaction a user has with the web application for the duration of the session
    
- The disclosure, capture, prediction, brute force, or fixation of the session ID will lead to session hijacking (or sidejacking) attacks
    
    where an attacker is able to fully impersonate a victim user in the web application
    

**Secure Session ID Generation Properties**

- The name used by the session ID should not be extremely descriptive nor offer unnecessary details about the purpose and meaning of the ID
- It is recommended to change the default session ID name of the web development framework to a generic name, such as “id”
- The session ID length must be at least 128 bits
- The session ID content (or value) must be meaningless to prevent information disclosure attacks, where an
    
    attacker is able to decode the contents of the ID and extract details of the user, the session, or the inner workings of the web application
    

### Session Expiration

Insufficient session expiration by the web application increases the exposure of other session-based attacks

### Session Logout/Ending

Web applications should provide mechanisms that allow security aware users to actively close their session once they have finished using the web application

### Session Attacks

- **Session Hijacking**: stealing someone’s session-id, and using it to impersonate that user
- **Session Fixation**: setting someone’s session-id to a predefined value, and impersonating them using that known value
- **Session Elevation**: when the importance of a session is changed, but its ID is not

**Session Hijacking**

- Mostly done via XSS attacks, mostly can be prevented by HTTP-Only session cookies
- Session-ids should be placed inside cookies, and not in URLs
    - The session cookie should have `HTTPOnly` attribute set
- An active session should be warned when it is accessed from another location

**Session Fixation**

- If the application sees a new session-id that is not present in the pool, it should be rejected and a new session-id should be advertised
- All the session-ids should be generated by the application, and then stored in a pool to be checked later for

**Session Elevation**

- Whenever a session is elevated (login, logout, certain authorization), it should be changed
- When a down-elevation occurs, the session information regarding the higher level should be flushed
